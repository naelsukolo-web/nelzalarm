<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe Player + Smart Alarm</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel untuk JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #050505;
            color: white;
            overflow: hidden;
            margin: 0;
        }

        .mono { font-family: 'JetBrains Mono', monospace; }

        /* Efek Animasi Background */
        .bg-animate {
            animation: slowPan 30s infinite alternate ease-in-out;
        }

        @keyframes slowPan {
            0% { transform: scale(1) translate(0, 0); }
            100% { transform: scale(1.1) translate(-2%, -2%); }
        }

        /* Desain Glassmorphism */
        .glass-panel {
            background: rgba(18, 18, 18, 0.75);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Animasi Equalizer */
        .eq-bar {
            width: 3px;
            background: #1db954;
            margin-right: 2px;
            border-radius: 2px;
            display: inline-block;
        }
        .eq-1 { height: 10px; animation: eq 0.8s infinite alternate; }
        .eq-2 { height: 16px; animation: eq 0.8s infinite alternate 0.2s; }
        .eq-3 { height: 12px; animation: eq 0.8s infinite alternate 0.4s; }

        @keyframes eq {
            0% { transform: scaleY(0.5); }
            100% { transform: scaleY(1.3); }
        }

        /* Menghilangkan panah input number */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        /* Alarm Screen Overlay */
        .alarm-flash {
            background: radial-gradient(circle, #1db954 0%, #000 100%);
            animation: pulseBg 1.5s infinite alternate;
        }

        @keyframes pulseBg {
            0% { opacity: 0.8; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const PLAYLIST = [
            { id: '1yXwA8jE0qU', title: 'Love Me Not', artist: 'Ravyn Lenae', cover: 'https://i.ytimg.com/vi/1yXwA8jE0qU/maxresdefault.jpg' },
            { id: 'mxyucLe9YE4', title: 'Lowkey', artist: 'NIKI', cover: 'https://i.ytimg.com/vi/mxyucLe9YE4/maxresdefault.jpg' },
            { id: 'zZ7i2F2W05Q', title: 'Hate Me', artist: 'Ellie Goulding', cover: 'https://i.ytimg.com/vi/zZ7i2F2W05Q/maxresdefault.jpg' },
            { id: 'S3zO5qQo-fA', title: 'Staying', artist: 'Lizzy McAlpine', cover: 'https://i.ytimg.com/vi/S3zO5qQo-fA/maxresdefault.jpg' }
        ];

        const App = () => {
            const [songIndex, setSongIndex] = useState(0);
            const [isPlaying, setIsPlaying] = useState(false);
            const [timerActive, setTimerActive] = useState(false);
            const [timeLeft, setTimeLeft] = useState(0);
            const [minInput, setMinInput] = useState("");
            const [secInput, setSecInput] = useState("");
            const [alarmTriggered, setAlarmTriggered] = useState(false);
            
            const playerRef = useRef(null);

            // Logika Timer
            useEffect(() => {
                let interval = null;
                if (timerActive && timeLeft > 0) {
                    interval = setInterval(() => {
                        setTimeLeft(prev => prev - 1);
                    }, 1000);
                } else if (timeLeft === 0 && timerActive) {
                    setTimerActive(false);
                    setAlarmTriggered(true);
                    setIsPlaying(false);
                    controlPlayer('pauseVideo');
                }
                return () => clearInterval(interval);
            }, [timerActive, timeLeft]);

            const controlPlayer = (command, args = []) => {
                if (playerRef.current?.contentWindow) {
                    playerRef.current.contentWindow.postMessage(JSON.stringify({
                        event: 'command', func: command, args
                    }), '*');
                }
            };

            const changeSong = (idx) => {
                setSongIndex(idx);
                setIsPlaying(true);
                // Delay agar iframe sempat memuat ID baru
                setTimeout(() => {
                    controlPlayer('unMute');
                    controlPlayer('playVideo');
                }, 500);
            };

            const togglePlay = () => {
                if (isPlaying) {
                    setIsPlaying(false);
                    controlPlayer('pauseVideo');
                } else {
                    setIsPlaying(true);
                    controlPlayer('playVideo');
                }
            };

            const startAlarm = () => {
                const totalSeconds = (parseInt(minInput || 0) * 60) + parseInt(secInput || 0);
                if (totalSeconds > 0) {
                    setTimeLeft(totalSeconds);
                    setTimerActive(true);
                    setAlarmTriggered(false);
                }
            };

            const formatDisplay = (s) => {
                const mins = Math.floor(s / 60);
                const secs = s % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };

            if (alarmTriggered) {
                return (
                    <div className="fixed inset-0 z-[100] alarm-flash flex flex-col items-center justify-center p-6 text-center">
                        <div className="mb-8 animate-bounce">
                            <svg width="100" height="100" fill="white" viewBox="0 0 24 24"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10zm0-2a8 8 0 110-16 8 8 0 010 16zm-1-11h2v5h-2V9zm0 6h2v2h-2v-2z"/></svg>
                        </div>
                        <h1 className="text-6xl md:text-8xl font-black mb-4">WAKTU HABIS!</h1>
                        <p className="text-xl mb-12 opacity-80 uppercase tracking-widest">Alarm Selesai - Musik Berhenti</p>
                        <button 
                            onClick={() => setAlarmTriggered(false)}
                            className="bg-white text-black px-12 py-4 rounded-full font-black text-xl hover:scale-105 transition-all shadow-2xl"
                        >
                            TUTUP ALARM
                        </button>
                    </div>
                );
            }

            return (
                <div className="relative h-screen w-full flex flex-col overflow-hidden bg-black">
                    
                    {/* Background Dinamis */}
                    <div className="absolute inset-0 z-0">
                        <div className="absolute inset-0 bg-cover bg-center bg-animate opacity-40" 
                             style={{ backgroundImage: `url('https://images.unsplash.com/photo-1614613535308-eb5fbd3d2c17?q=80&w=2070')` }}>
                        </div>
                        <div className="absolute inset-0 bg-gradient-to-b from-transparent via-black/60 to-black"></div>
                    </div>

                    {/* Hidden YT Engine */}
                    <div className="fixed -bottom-96">
                        <iframe 
                            ref={playerRef}
                            src={`https://www.youtube.com/embed/${PLAYLIST[songIndex].id}?enablejsapi=1&autoplay=0`} 
                        />
                    </div>

                    {/* Konten Utama */}
                    <main className="relative z-10 flex-1 flex flex-col md:flex-row p-6 md:p-12 gap-8 items-center overflow-hidden">
                        
                        {/* Area Kiri: Cover & Timer */}
                        <div className="w-full md:w-1/2 flex flex-col items-center">
                            <div className={`w-full aspect-square max-w-[350px] rounded-[2.5rem] overflow-hidden shadow-2xl transition-all duration-1000 ${isPlaying ? 'scale-100' : 'scale-90 opacity-50'}`}>
                                <img src={PLAYLIST[songIndex].cover} className="w-full h-full object-cover" alt="Album Cover" />
                            </div>
                            
                            {/* Kotak Kontrol Alarm */}
                            <div className="mt-8 w-full max-w-[350px] glass-panel p-6 rounded-3xl">
                                <h3 className="text-[10px] font-black uppercase tracking-[0.2em] text-white/40 mb-4">Smart Timer Alarm</h3>
                                {timerActive ? (
                                    <div className="text-center py-2">
                                        <div className="text-5xl font-black mono text-[#1db954] mb-4 tracking-tighter">
                                            {formatDisplay(timeLeft)}
                                        </div>
                                        <button onClick={() => setTimerActive(false)} className="text-[10px] text-red-500 font-bold uppercase tracking-widest hover:underline">Batalkan</button>
                                    </div>
                                ) : (
                                    <div className="flex flex-col gap-4">
                                        <div className="flex justify-center items-center gap-3">
                                            <input type="number" placeholder="Min" value={minInput} onChange={e => setMinInput(e.target.value)} className="w-16 bg-white/5 border border-white/10 rounded-xl py-3 text-center text-xl font-bold mono outline-none focus:bg-white/10" />
                                            <span className="text-white/20 font-bold">:</span>
                                            <input type="number" placeholder="Sec" value={secInput} onChange={e => setSecInput(e.target.value)} className="w-16 bg-white/5 border border-white/10 rounded-xl py-3 text-center text-xl font-bold mono outline-none focus:bg-white/10" />
                                        </div>
                                        <button onClick={startAlarm} className="w-full bg-white text-black font-black py-3 rounded-xl hover:bg-[#1db954] transition-colors active:scale-95">SETEL ALARM</button>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Area Kanan: Playlist */}
                        <div className="w-full md:w-1/2 h-full flex flex-col glass-panel rounded-[2.5rem] p-6 md:p-8 overflow-hidden shadow-2xl">
                            <h2 className="text-xl font-bold mb-6 flex items-center gap-3">
                                <span className="w-2 h-2 bg-[#1db954] rounded-full"></span> Koleksi Lagu
                            </h2>
                            <div className="flex-1 overflow-y-auto custom-scroll pr-2 space-y-2">
                                {PLAYLIST.map((song, idx) => (
                                    <div 
                                        key={idx} 
                                        onClick={() => changeSong(idx)}
                                        className={`flex items-center p-3 rounded-2xl cursor-pointer transition-all ${songIndex === idx ? 'bg-white/10 ring-1 ring-white/10' : 'hover:bg-white/5'}`}
                                    >
                                        <div className="relative w-12 h-12 mr-4 flex-shrink-0">
                                            <img src={song.cover} className="w-full h-full object-cover rounded-xl" />
                                            {songIndex === idx && isPlaying && (
                                                <div className="absolute inset-0 bg-black/40 flex items-center justify-center rounded-xl">
                                                    <div className="eq-bar eq-1"></div>
                                                    <div className="eq-bar eq-2"></div>
                                                    <div className="eq-bar eq-3"></div>
                                                </div>
                                            )}
                                        </div>
                                        <div className="flex-1 min-w-0">
                                            <p className={`font-bold truncate text-sm ${songIndex === idx ? 'text-[#1db954]' : 'text-white'}`}>{song.title}</p>
                                            <p className="text-[10px] text-white/40 font-bold uppercase">{song.artist}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </main>

                    {/* Player Footer Bar */}
                    <footer className="relative z-20 glass-panel h-24 border-t border-white/5 px-8 md:px-12 flex items-center justify-between">
                        <div className="hidden md:flex items-center w-1/4">
                            <div>
                                <h4 className="font-bold text-xs truncate max-w-[150px]">{PLAYLIST[songIndex].title}</h4>
                                <p className="text-[9px] text-white/30 font-black uppercase tracking-widest">{PLAYLIST[songIndex].artist}</p>
                            </div>
                        </div>
                        
                        <div className="flex flex-col items-center flex-1">
                            <div className="flex items-center gap-8">
                                <button onClick={() => changeSong((songIndex - 1 + PLAYLIST.length) % PLAYLIST.length)} className="text-white/40 hover:text-white transition-all"><svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/></svg></button>
                                <button onClick={togglePlay} className="w-12 h-12 bg-white text-black rounded-full flex items-center justify-center hover:scale-110 active:scale-95 transition-all shadow-xl">
                                    {isPlaying ? <svg width="22" height="22" fill="currentColor" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg> : <svg width="22" height="22" fill="currentColor" viewBox="0 0 24 24" className="ml-1"><path d="M8 5v14l11-7z"/></svg>}
                                </button>
                                <button onClick={() => changeSong((songIndex + 1) % PLAYLIST.length)} className="text-white/40 hover:text-white transition-all"><svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/></svg></button>
                            </div>
                        </div>

                        <div className="hidden md:flex items-center justify-end w-1/4 opacity-20">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M11 5L6 9H2v6h4l5 4V5zm8.5 7c0-2.5-1.5-4.5-3.5-5.5v11c2-1 3.5-3 3.5-5.5z"/></svg>
                        </div>
                    </footer>

                    {/* floating tip */}
                    {!isPlaying && !alarmTriggered && (
                         <div className="absolute top-8 left-1/2 -translate-x-1/2 z-50 bg-[#1db954] text-black text-[10px] font-black px-8 py-3 rounded-full animate-bounce shadow-xl uppercase tracking-widest">
                            Klik Play untuk mengaktifkan musik & alarm
                         </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>